<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="一个Blog系统"><title>高效清晰Layout布局文件的一些技巧 | Jimmy的平行世界</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.1.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">高效清晰Layout布局文件的一些技巧</h1><a id="logo" href="/.">Jimmy的平行世界</a><p class="description">欢迎来到Jimmy的世界上天下地</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/reading/"><i class="fa fa-book"> 读书</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">高效清晰Layout布局文件的一些技巧</h1><div class="post-meta">Aug 8, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-thread-key="2016/08/08/android01/" href="/2016/08/08/android01/#comments" class="ds-thread-count"></a><div class="post-content"><p>当人们谈论Android性能的时候总是习惯讨论怎么写出清晰高效的Java代码,却忽略了layout布局文件。layout布局缓慢的渲染速度对app性能也有的很大的影响。充满不必要的views和可读性差的layout文件会让你的app运行缓慢。在本文中我会分享5个技巧来帮你写出高效清晰的layout布局文件。</p>
<h3 id="1-用TextView本身的属性同时显示图片和文字"><a href="#1-用TextView本身的属性同时显示图片和文字" class="headerlink" title="1.用TextView本身的属性同时显示图片和文字"></a>1.用TextView本身的属性同时显示图片和文字</h3><p>通常你需要在文本旁边添加一张图片，假设你需要添加图片在文字的左边，像下面这样：<br><img src="http://blog-10057188.cos.myqcloud.com/android01.png" alt=""></p>
<p>不少人首先想到的就是用一个LinearLayout或RelativeLayou来包含一个TextView和ImageView,最后你用了三个UI元素和一大坨代码。用TextView的compound drawable是一个更好更清晰的解决方案。你只需要一个属性就可以搞定。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:text=&quot;@string/batman&quot;</span><br><span class="line">        android:drawableLeft=&quot;@drawable/batman&quot;</span><br><span class="line">        android:drawableStart=&quot;@drawable/batman&quot;</span><br><span class="line">        android:drawablePadding=&quot;5dp&quot;&gt;</span><br><span class="line">&lt;/TextView&gt;</span><br></pre></td></tr></table></figure></p>
<p>用到的主要属性：</p>
<p>drawableLeft- 指定drawable放在文本的左边</p>
<p>drawableStart- 作用和drawableLeft相同但是它基于新的API(android 4.2)支持RTL</p>
<p>drawablePadding- 指定文本和drawable之间padding</p>
<h3 id="2-同时使用ImageView的src和background属性实现点击效果"><a href="#2-同时使用ImageView的src和background属性实现点击效果" class="headerlink" title="2.同时使用ImageView的src和background属性实现点击效果"></a>2.同时使用ImageView的src和background属性实现点击效果</h3><p>你应该同时使用它们，在很多情况下你会想要给ImageView添加点击效果，然后我看到很多人用LinearLayout来包裹一个ImageView来实现。添加另一个view是没必要的。下面的代码可以让你做的更好：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/image&quot;</span><br><span class="line">        android:layout_width=&quot;@dimen/batman_logo_width&quot;</span><br><span class="line">        android:layout_height=&quot;@dimen/batman_logo_height&quot;</span><br><span class="line">        android:background=&quot;?attr/selectableItemBackground&quot;//点击效果</span><br><span class="line">        android:src=&quot;@drawable/batman_logo_transparent&quot;//图片</span><br><span class="line">        style=&quot;@style/logo_image_style&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>显示图片用”src”属性，drawable selector 图片点击效果用”background”属性实现，上面用的是android默认提供的selector,当然你也可以换成你自己实现的。</p>
<h3 id="3-用LinearLayout自带的分割线"><a href="#3-用LinearLayout自带的分割线" class="headerlink" title="3.用LinearLayout自带的分割线"></a>3.用LinearLayout自带的分割线</h3><p>分割线在app经常会用到的，使用频率高到让你惊讶。但是LinearLayout有一个属性可以帮你添加分割线。下面的例子中，LinearLayout包含2个TextView和基于他们中间的分割线。<br><img src="http://blog-10057188.cos.myqcloud.com/android03.png" alt=""></p>
<h4 id="3-1-Create-divider-shape-创建shape"><a href="#3-1-Create-divider-shape-创建shape" class="headerlink" title="3.1 Create divider shape(创建shape)"></a>3.1 Create divider shape(创建shape)</h4><p>下面是一个简单的shape divider_horizontal.xml用来当做分割线。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;size android:width=&quot;@dimen/divider_width&quot;/&gt;</span><br><span class="line">    &lt;solid android:color=&quot;@color/colorPrimaryDark&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/shape&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-2Add-shape-to-LinearLayout"><a href="#3-2Add-shape-to-LinearLayout" class="headerlink" title="3.2Add shape to LinearLayout"></a>3.2Add shape to LinearLayout</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout android:layout_width=&quot;match_parent&quot;</span><br><span class="line">              android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">              android:orientation=&quot;horizontal&quot;</span><br><span class="line">              android:background=&quot;@android:color/white&quot;</span><br><span class="line">              android:divider=&quot;@drawable/divider_horizontal&quot;  //添加分割线</span><br><span class="line">              android:dividerPadding=&quot;5dp&quot; //设置padding</span><br><span class="line">              android:showDividers=&quot;middle&quot;&gt;//居中显示</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;TextView android:layout_width=&quot;0dp&quot;</span><br><span class="line">              android:layout_weight=&quot;0.5&quot;</span><br><span class="line">              android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">              android:gravity=&quot;center&quot;</span><br><span class="line">              style=&quot;@style/Text.Title&quot;</span><br><span class="line">              android:text=&quot;@string/batman_name&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;TextView android:layout_width=&quot;0dp&quot;</span><br><span class="line">              android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">              android:layout_weight=&quot;0.5&quot;</span><br><span class="line">              android:gravity=&quot;center&quot;</span><br><span class="line">              style=&quot;@style/Text.Title&quot;</span><br><span class="line">              android:text=&quot;@string/superman_name&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure>
<p>上面用到了三个xml属性：</p>
<p>divider -用来定义一个drawable或者color作为分割线</p>
<p>showDividers -指定分割线在哪里显示，它们可以显示在开始位置，中间，末尾或者选择不显示</p>
<p>dividerPadding -给divider添加padding</p>
<h3 id="4-使用Space控件"><a href="#4-使用Space控件" class="headerlink" title="4.使用Space控件"></a>4.使用Space控件</h3><p>当你需要在2个UI控件添加间距的时候,你可能会添加padding或margin。有时最终的layout文件是非常混乱，可读性非常差。当你需要解决问题时，你突然意识到这里有一个5dp的paddingTop,那里有一个2dp的marginBottom,还有一个4dp的paddingBottom在第三个控件上然后你很难弄明白到底是哪个控件导致的问题。还有我发现有些人在2个控件之间添加LinearLayout或View来解决这个问题，看起来是一个很简单解决方案但是对App的性能有很大的影响。</p>
<p>这里有一个更简单更容易的方法那就是Space,看下官方的文档：“Space is a lightweight View subclass that may be used to create gaps between components in general purpose layouts.” 他们没有说谎，确实很轻量。如果你看过Space的实现会发现Space继承View但是没有绘制任何东西在canvas。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Draw nothing.</span><br><span class="line"> *</span><br><span class="line"> * @param canvas an unused parameter.</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void draw(Canvas canvas) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用方法很简单，看下面的图片，我们想要在在标题和描述之间添加间距。<br><img src="http://blog-10057188.cos.myqcloud.com/android04.png" alt=""></p>
<p>你只需要简单的在2个TextView之间添加一个Space就可以了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView android:layout_width=&quot;match_parent&quot;</span><br><span class="line">          android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">          style=&quot;@style/Text.Title&quot;</span><br><span class="line"></span><br><span class="line">&lt;Space android:layout_width=&quot;match_parent&quot;</span><br><span class="line">       android:layout_height=&quot;10dp&quot;/&gt;//添加间距</span><br><span class="line"></span><br><span class="line">&lt;TextView android:layout_width=&quot;match_parent&quot;</span><br><span class="line">          android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">          android:text=&quot;@string/gotham_city_description&quot;</span><br><span class="line">          style=&quot;@style/Text.Details&quot;/&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="5-使用和标签"><a href="#5-使用和标签" class="headerlink" title="5.使用和标签"></a>5.使用<include>和<merge>标签</merge></include></h3><p>重用布局是一个保持app一致的好方法，这样以后有改变的话只要改一个文件就可以了，Android提供了<include>标签帮你重用布局。</include></p>
<p>例如你现在决定创建有一个logo图片居中的酷炫Toolbar工具栏，然后你想要添加到每个页面中<br>下面是batman_toolbar.xml代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">        android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">        android:background=&quot;?attr/colorPrimary&quot;</span><br><span class="line">        android:theme=&quot;@style/AppTheme.AppBarOverlay&quot;</span><br><span class="line">        app:popupTheme=&quot;@style/AppTheme.PopupOverlay&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;ImageView android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">               android:layout_height=&quot;@dimen/batman_logo_height&quot;</span><br><span class="line">               android:layout_gravity=&quot;center&quot;</span><br><span class="line">               android:src=&quot;@drawable/batman_logo_transparent&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.v7.widget.Toolbar&gt;</span><br></pre></td></tr></table></figure></p>
<p>你可以复制粘贴这些代码到每个Activity,但是不要这么做，在编程中有一个重要的规则：当你复制粘贴，那你就是在做错误的事。在这种情况下你可以用<include>标签在多个界面重用这个布局。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.design.widget.CoordinatorLayout</span><br><span class="line">        xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">        xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;</span><br><span class="line">        android:fitsSystemWindows=&quot;true&quot;</span><br><span class="line">        android:background=&quot;@android:color/white&quot;</span><br><span class="line">        tools:context=&quot;.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;include layout=&quot;@layout/batman_toolbar&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure></include></p>
<p>用<include>标签你可以只用一行代码在app的每个页面添加你的toolbar,任何改变都会自动更新到所有页面。</include></p>
<p>除了<include>,<merge>也常用来从你的view层次结构中减不必要的view，它会移除没必要的嵌套的layouts，例如，如果被包含布局文件的根是一个LinearLayout,然后你把它include包含在另外一个LinearLayout里面，2个嵌套的LinearLayouts是没有必要的，这个嵌套的layout没有任何作用除了影响UI性能。在这种情况下可以用<merage \="">来替换被包含布局的根LinarLayout 移除不必要的view.</merage></merge></include></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/08/08/android01/" data-id="cirmyfh8l00070xsayozgzg9w" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Android/">Android</a></div><div class="post-nav"><a href="/2016/07/07/git01/" class="next">配置SSH keys</a></div><div data-thread-key="2016/08/08/android01/" data-title="高效清晰Layout布局文件的一些技巧" data-url="http://yoursite.com/2016/08/08/android01/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/08/08/android01/" data-title="高效清晰Layout布局文件的一些技巧" data-url="http://yoursite.com/2016/08/08/android01/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Ubuntu/" style="font-size: 15px;">Ubuntu</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/08/08/android01/">高效清晰Layout布局文件的一些技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/07/git01/">配置SSH keys</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/04/mac01/">在Mac OS X中开启或关闭显示隐藏文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/02/hexo01/">给博客系统绑定域名</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/18/ubuntu01/">Ubuntu在Vmware中自动适配屏幕</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/15/hello-world/">Hexo的使用方法</a></li></ul></div><div class="widget"><div class="comments-title"><i class="fa fa-comment-o"> 最近评论</i></div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/jimmy621" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="http://gold.xitu.io/" title="稀土掘金" target="_blank">稀土掘金</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Jimmy的平行世界.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>var duoshuoQuery = {short_name:'jimmy621'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e90c71d87f18d3f94104426d0dcdf917";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>